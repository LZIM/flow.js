(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
"use strict";var addControlPanel=require("./panels/legend-toggle/legend-panel");var codePanel=require("./panels/code-show/code-show.html");var FlowInspector=function(root){function draw(el,elementTop,elementLeft,elementWidth,elementHeight,fillColor){var ctx=el.getContext("2d");ctx.fillStyle=fillColor,ctx.fillRect(elementLeft,elementTop,elementWidth,elementHeight)}function eraseCanvas(el,elementTop,elementLeft,elementWidth,elementHeight){var ctx=el.getContext("2d");var offset=0;ctx.clearRect(elementLeft-offset,elementTop-offset,elementWidth+2*offset,elementHeight+2*offset)}var drawModalCanvas=function(){var $canvas=$('<canvas class="f-modal"></canvas>');var windowHeight=$(document).height();var windowWidth=$(document).width();$canvas.attr({width:windowWidth,height:windowHeight}),$(root).append($canvas);var el=$canvas.get(0);return draw(el,0,0,windowWidth,windowHeight,"rgba(0,0,0,.4)"),el};var getClassNames=function(elem,attr){var elemType=elem.nodeName.toLowerCase();var isInputElement=-1!==["input","a","button"].indexOf(elemType);var classNames=[];return classNames.push(isInputElement?"f-input":"f-output"),0===attr.indexOf("on-")?classNames.push("f-on"):0===attr.indexOf("bind")?classNames.push("f-bind"):0===attr.indexOf("foreach")?classNames.push("f-foreach"):classNames.push("f-custom"),classNames.join(" ")};var config=Flow.channel.run.getCurrentConfig();config.token="eyJhbGciOiJSUzI1NiJ9.eyJqdGkiOiI3YmM5MTI3My0yOGQzLTQyYWUtYTFhMy05YzEwYzg3ZmM0NTMiLCJzdWIiOiIwOTdlOTMzMC1mOWYyLTQ0MTAtYTY3My0wYTQwNzkyZjFkMTgiLCJzY29wZSI6WyJvYXV0aC5hcHByb3ZhbHMiLCJvcGVuaWQiXSwiY2xpZW50X2lkIjoibG9naW4iLCJjaWQiOiJsb2dpbiIsImdyYW50X3R5cGUiOiJwYXNzd29yZCIsInVzZXJfaWQiOiIwOTdlOTMzMC1mOWYyLTQ0MTAtYTY3My0wYTQwNzkyZjFkMTgiLCJ1c2VyX25hbWUiOiJucmFuaml0QGZvcmlvLmNvbSIsImVtYWlsIjoibnJhbmppdEBmb3Jpby5jb20iLCJwYXJlbnRfYWNjb3VudF9pZCI6bnVsbCwiaWF0IjoxNDQ5ODU3ODMwLCJleHAiOjE0NDk5MDEwMzAsImlzcyI6Imh0dHA6Ly9sb2NhbGhvc3Q6OTc2My91YWEvb2F1dGgvdG9rZW4iLCJhdWQiOlsib2F1dGgiLCJvcGVuaWQiXX0.iE2FccE3UqWBSmTQxraz0Isyb5w17aki1Q_BY_yM0qvdVLxIPq17oCtY3u8cL2uqLeIqvyvH7WRUvccadbh1fOisPX-V2NyfJg0sV82ti_yy4McDW-7ja8ilwP1QDXzsCOlMs4xyfCnd9KyJ7DiwYbrK2uhMvxV3NtFaH3WbrDLptf128zl3olLHN3XuyB0gvXHnfeitgDh-J79Kl7gC8JkGNK5_q--FddjJFVQz-dTwsPMzGQt-Tro7Hu45ACyn07B4IaFqIggmOtR9cUD7pao_YNzgMetLQ5mMz3ExIasWciqQ8E32S6S6s_Jp_3CpyZdCwlUWumI8yeZTsS9TAg";var file=new F.service.File(config);var promise=file.getFileContents(config.model,"model").then(function(x){var ret=x.split(/\n/);return _.invoke(ret,"trim")});var findContext=function(codeArray,variable,isFunction){variable=variable.split(/[\[\.\(]/)[0];var regExp;isFunction?(variable="function "+variable,regExp=new RegExp("^"+variable)):regExp=new RegExp("^"+variable+"\\s?=");var offset=isFunction?2:1;var isEnd=function(val){return isFunction?"end"===val:""===val||-1!==val.indexOf("=")};var startIndex=_.findIndex(codeArray,function(val){return regExp.test(val)});var fromStart=codeArray.slice(startIndex+1);var endIndex=_.findIndex(fromStart,isEnd);return codeArray.slice(startIndex,startIndex+endIndex+offset)};$(function(){var canvas=drawModalCanvas();var $overlayContainer=$('<div class="f-item-containers"></div>');var $codePanel=$(codePanel);var elemCounter=0;$(":f").each(function(index,elem){elemCounter++;var $thisElemContainer=$('<div id="f-container-'+elemCounter+'"></div');var pos=$(elem).offset();$thisElemContainer.css({top:pos.top-25+"px",left:pos.left+"px"}),$(elem).children().length||eraseCanvas(canvas,pos.top,pos.left,$(elem).innerWidth(),$(elem).innerHeight(),elem),$(elem.attributes).each(function(index,nodeMap){var attr=nodeMap.nodeName;var wantedPrefix="data-f-";if(0===attr.indexOf(wantedPrefix)){attr=attr.replace(wantedPrefix,"");var displayAttrName=attr.replace("on-","");var chain=_.invoke(nodeMap.value.split("|"),"trim");var originalVal=chain.shift();var $type=$('<span class="f-type"></span>').text(displayAttrName);var $val=$('<span class="f-val"></span>').text(originalVal);var $newEl=$("<div> </div>").append($type).append($val);chain.forEach(function(val){var cname=0===attr.indexOf("on")?"f-val":"f-conv";var $conv=$('<span class="'+cname+'"></span').text(val);$newEl.append($conv)}),$newEl.addClass(getClassNames(elem,attr)),$thisElemContainer.append($newEl)}}),$thisElemContainer.on("click",".f-bind, .f-foreach",function(evt){var $target=$(evt.target).is(".f-val")?$(evt.target):$(evt.target).parent().find(".f-val");var variableName=$target.text().trim();promise.then(function(data){var context=findContext(data,variableName);$codePanel.find("pre").html(context)})}),$thisElemContainer.on("click",".f-on",function(evt){var $target=$(evt.target).is(".f-val")?$(evt.target):$(evt.target).parent().find(".f-val");var variableName=$target.text().trim();promise.then(function(data){var context=findContext(data,variableName,!0);$codePanel.find("pre").html(context)})}),$overlayContainer.append($thisElemContainer)});var evtName="f-select:type";addControlPanel($overlayContainer,evtName),$overlayContainer.on(evtName,function(evt,type){$(root).toggleClass("hide-f-"+type)}),$(root).prepend($overlayContainer),$overlayContainer.append($codePanel)})};window.Flow.Inspector=FlowInspector,module.exports=FlowInspector;
},{"./panels/code-show/code-show.html":2,"./panels/legend-toggle/legend-panel":4}],2:[function(require,module,exports){
module.exports='<div class="f-panel f-code-inspector">\n    <h6> Click on one of the variables on the right to inspect. </h6>\n    <code>\n        <pre>\n\n        </pre>\n    </code>\n</div>\n';
},{}],3:[function(require,module,exports){
module.exports='<div class="f-legend-panel f-panel">\n    <h6> Outputs </h6>\n\n    <label class="f-output">\n        <input type="checkbox" checked />\n        <div class="f-bind">\n            <span class="f-type">Bind</span>\n            <span class="f-val">Variable Name</span>\n            <span class="f-conv">Converters</span>\n        </div>\n    </label>\n    <label class="f-output">\n        <input type="checkbox" checked />\n        <div class="f-foreach">\n            <span class="f-type">Loop</span>\n            <span class="f-val">Variable Name</span>\n            <span class="f-conv">Converters</span>\n        </div>\n    </label>\n    <label class="f-output">\n        <input type="checkbox" checked />\n        <div class="f-custom">\n            <span class="f-type">Custom</span>\n            <span class="f-val">Variable Name</span>\n            <span class="f-conv">Converters</span>\n        </div>\n    </label>\n\n    <h6> Inputs </h6>\n    <label class="f-input">\n        <input type="checkbox" checked />\n        <div class="f-bind">\n            <span class="f-type">Bind</span>\n            <span class="f-val">Variable Name</span>\n            <span class="f-conv">Converters</span>\n        </div>\n    </label>\n\n    <label class="f-input">\n        <input type="checkbox" checked />\n        <div class="f-on">\n            <span class="f-type">Event</span>\n            <span class="f-val">Operation</span>\n        </div>\n    </label>\n</div>\n';
},{}],4:[function(require,module,exports){
"use strict";module.exports=function($container,evtName){var template=require("./legend-panel.html");var $html=$(template);$container.append($html),$container.on("click",":checkbox",function(evt){evt.stopPropagation();var $target=$(evt.target);var type=$target.parent().attr("class").replace("f-","");var subType=$target.parent().children("[class^=f-]").attr("class").replace("f-","");$container.trigger(evtName,type+"-"+subType)});var xOffset=0;var yOffset=0;var isDragged=!1;$html.on("mousedown",function(evt){return xOffset=evt.clientX-$html.offset().left,yOffset=evt.clientY-$html.offset().top,isDragged=!0,!1}),$html.on("mousemove",function(evt){return isDragged?(evt.stopPropagation(),$html.css({top:evt.clientY-yOffset,left:evt.clientX-xOffset}),!1):void 0}),$html.on("mouseup",function(evt){isDragged=!1})};
},{"./legend-panel.html":3}]},{},[1])


//# sourceMappingURL=flow-inspector.min.js.map