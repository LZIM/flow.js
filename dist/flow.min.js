!function(t,e,n){function r(n,a){if(!e[n]){if(!t[n]){var o="function"==typeof require&&require;if(!a&&o)return o(n,!0);if(i)return i(n,!0);throw new Error("Cannot find module '"+n+"'")}var s=e[n]={exports:{}};t[n][0].call(s.exports,function(e){var i=t[n][1][e];return r(i?i:e)},s,s.exports)}return e[n].exports}for(var i="function"==typeof require&&require,a=0;a<n.length;a++)r(n[a]);return r}({1:[function(t){window.Flow=t("./flow.js")},{"./flow.js":2}],2:[function(t,e){"use strict";var n=t("./dom/dom-manager"),r=t("./channels/channel-manager");e.exports={dom:n,initialize:function(t){var e=$("body").data("f-model"),i={channel:{account:"",project:"",model:e},dom:{}},a=$.extend(!0,{},i,t);this.channel=t&&t.channel&&t.channel instanceof r?t.channel:new r(a.channel),n.initialize($.extend(!0,{channel:this.channel}))}}},{"./dom/dom-manager":3,"./channels/channel-manager":4}],3:[function(t,e){e.exports=function(){"use strict";var e=t("../config"),n=t("./nodes/node-manager.js"),r=t("./attributes/attribute-manager.js"),i=t("../converters/converter-manager.js"),a=t("../utils/parse-utils");$.expr[":"][e.prefix]=function(t){var n=$(t),r=_.keys(n.data()),i=_.find(r,function(t){return 0===t.indexOf(e.prefix)});return!!i},$.expr[":"].webcomponent=function(t){return console.log(t),-1!==t.nodeName.indexOf("-")};var o={nodes:n,attributes:r,converters:i,"private":{},initialize:function(t){var o={root:"body",channel:null};$.extend(o,t);var s=o.channel,u=this,c=$(o.root);$(function(){var t=c.find(":"+e.prefix);c.is(":"+e.prefix)&&(t=t.add($(o.root))),u.private.matchedElements=t,$.each(t,function(t,e){var i=$(e),a=n.getHandler(i);console.log(e,a.selector),new a.handle({el:e});var o=i.data("variable-attr-map");o||(o={},$(e.attributes).each(function(t,e){var n=e.nodeName,a=e.value,s="data-f-";if(0===n.indexOf(s)){n=n.replace(s,"");var u=_.invoke(a.split("|"),"trim");u.length>1&&(a=u.shift(),i.data("f-converters-"+n,u));var c=r.getHandler(n,i),l=!0;if(c&&c.init&&(l=c.init.call(i,n,a)),l){var f=/,(?![^\[]*\])/;a.split(f).length>1||(o[a]=n)}}}),i.data("variable-attr-map",o));var u=Object.keys(o);u.length&&s.variables.subscribe(Object.keys(o),i)}),c.off(e.events.react).on(e.events.react,function(t,e){var n=$(t.target),a=n.data("variable-attr-map");$.each(e,function(t,e){var o=a[t.trim()];if(o){var s=n.data("f-converters-"+o);if(!s&&"bind"===o){if(s=n.data("f-convert"),!s){var u=n.closest("[data-f-convert]");u&&(s=u.data("f-convert"))}s&&(s=s.split("|"))}var c=i.convert(e,s);o=o.toLowerCase();var l=r.getHandler(o,n);l.handle.call(n,c,o)}})}),c.off(e.events.trigger).on(e.events.trigger,function(t,e){e=$.extend(!0,{},e),_.each(e,function(t,n){e[n]=a.toImplicitType(t)}),s.variables.publish(e)}),c.off("f.ui.operate").on("f.ui.operate",function(t,e){e=$.extend(!0,{},e),e.args=_.map(e.args,function(t){return a.toImplicitType($.trim(t))}),s.operations.publish(e.fn,e.args)})})}};return $.extend(this,o)}()},{"./nodes/node-manager.js":5,"./attributes/attribute-manager.js":6,"../converters/converter-manager.js":7,"../config":8,"../utils/parse-utils":9}],4:[function(t,e){"use strict";var n=t("./variables-channel"),r=t("./operations-channel");e.exports=function(t){t||(t={});var e=t,i=new F.service.Run(e);window.run=i;var a=i.create(t.model);i.currentPromise=a;var o=function(t,e){return _.wrap(t,function(t){var n=_.toArray(arguments).slice(1);return i.currentPromise.then(function(){return i.currentPromise=t.apply(e,n),i.currentPromise})})};_.each(i,function(t,e){$.isFunction(t)&&"variables"!==e&&(i[e]=o(t,i))});var s=i.variables();_.each(s,function(t,e){$.isFunction(t)&&(s[e]=o(t,s))}),this.run=i,this.variables=new n({run:i,vent:this}),this.operations=new r({run:i,vent:this})}},{"./variables-channel":10,"./operations-channel":11}],8:[function(t,e){e.exports={prefix:"f",defaultAttr:"bind",binderAttr:"f-bind",events:{trigger:"update.f.ui",react:"update.f.model"}}},{}],9:[function(t,e){"use strict";e.exports={toImplicitType:function(t){var e=/^(?:\{.*\}|\[.*\])$/,n=t;return"string"==typeof t&&(t=t.trim(),"true"===t?n=!0:"false"===t?n=!1:"null"===t?n=null:"undefined"===t?n="":"'"===n.charAt(0)||'"'===n.charAt(0)?n=t.substring(1,t.length-1):$.isNumeric(t)?n=+t:e.test(t)&&(n=$.parseJSON(t))),n}}},{}],11:[function(t,e){"use strict";e.exports=function(t){t||(t={});var e=t.run,n=t.vent,r={listenerMap:{},refresh:function(t,e){$(n).trigger("dirty",{opn:t,response:e})},publish:function(t,n){console.log("operations publish",t,n);var r=this;return e.do.apply(e,arguments).then(function(e){r.refresh.call(r,t,e)})},subscribe:function(t,e){console.log("operations subscribe",t,e),t=[].concat(t),e.on||(e=$(e));var n=_.uniqueId("epichannel.operation"),r={id:n,target:e},i=this;return $.each(t,function(t,e){i.listenerMap[e]=i.listenerMap[e].concat(r)}),n},unsubscribe:function(t,e){this.listenerMap=_.reject(this.listenerMap,function(t){return t.id===e})},unsubscribeAll:function(){this.listenerMap=[]}};return $.extend(this,r)}},{}],7:[function(t,e){"use strict";var n=function(t,e){var n=[];return _.isFunction(e)?n.push({alias:t,convert:e}):_.isObject(t)&&(t.convert?n.push(t):$.each(t,function(t,e){n.push({alias:t,convert:e})})),n},r=function(t,e){return _.isString(e.alias)?t===e.alias:_.isFunction(e.alias)?e.alias(t):_.isRegex(e.alias)?e.alias.match(t):!1},i={"private":{matchConverter:r},list:[],register:function(t,e){var r=n(t,e);this.list=r.concat(this.list)},replace:function(t,e){var i;_.each(this.list,function(e,n){return r(t,e)?(i=n,!1):void 0}),this.list.splice(i,1,n(t,e)[0])},getConverter:function(t){return _.find(this.list,function(e){return r(t,e)})},convert:function(t,e){if(!e||!e.length)return t;e=[].concat(e),e=_.invoke(e,"trim");var n=t,r=this;return _.each(e,function(t){var e=r.getConverter(t);n=e.convert(n,t)}),n}},a=[t("./number-converter"),t("./string-converter"),t("./numberformat-converter")];$.each(a.reverse(),function(t,e){i.register(e)}),e.exports=i},{"./number-converter":12,"./string-converter":13,"./numberformat-converter":14}],5:[function(t,e){"use strict";var n=[t("./input-checkbox-node"),t("./default-input-node"),t("./default-node")],r=[],i=function(t,e){return _.isFunction(e)&&(e={handle:e}),t||(t="*"),e.selector=t,e};$.each(n,function(t,e){r.push(i(e.selector,e))});var a=function(t,e){return _.isString(t)?t===e.selector:$(t).is(e.selector)};e.exports={list:r,register:function(t,e){r.unshift(i(t,e))},getHandler:function(t){return _.find(r,function(e){return a(t,e)})},replace:function(t,e){var n;_.each(r,function(e,r){return t===e.selector?(n=r,!1):void 0}),r.splice(n,1,i(t,e))}}},{"./input-checkbox-node":15,"./default-input-node":16,"./default-node":17}],6:[function(t,e){"use strict";var n=[t("./no-op-attr"),t("./events/init-event-attr"),t("./events/default-event-attr"),t("./binds/checkbox-radio-bind-attr"),t("./binds/input-bind-attr"),t("./class-attr"),t("./positive-boolean-attr"),t("./negative-boolean-attr"),t("./binds/default-bind-attr"),t("./default-attr")],r=[],i=function(t,e,n){return e||(e="*"),_.isFunction(n)&&(n={handle:n}),$.extend(n,{test:t,target:e})};$.each(n,function(t,e){r.push(i(e.test,e.target,e))});var a=function(t,e,n){var r;return _.isString(t)?r="*"===t||t.toLowerCase()===e.toLowerCase():_.isFunction(t)?r=t(e,n):_.isRegExp(t)&&(r=e.match(t)),r},o=function(t,e){return _.isString(e)?e===t:e.is(t)};e.exports={list:r,register:function(){r.unshift(i.apply(null,arguments))},filter:function(t,e){var n=_.select(r,function(e){return a(e.test,t)});return e&&(n=_.select(n,function(t){return o(t.target,e)})),n},replace:function(t,e,n){var s;_.each(r,function(n,r){return a(n.test,t)&&o(n.target,e)?(s=r,!1):void 0}),r.splice(s,1,i(t,e,n))},getHandler:function(t,e){var n=this.filter(t,e);return n[0]}}},{"./no-op-attr":18,"./events/init-event-attr":19,"./events/default-event-attr":20,"./binds/checkbox-radio-bind-attr":21,"./binds/input-bind-attr":22,"./class-attr":23,"./positive-boolean-attr":24,"./negative-boolean-attr":25,"./binds/default-bind-attr":26,"./default-attr":27}],10:[function(t,e){"use strict";var n=t("../config");e.exports=function(t){t||(t={});var e=t.run.variables(),r=t.vent,i={},a=function(){return!1},o=function(t){var e=t.match(/<(.*?)>/g);return e=_.map(e,function(t){return t.substring(1,t.length-1)})},s=function(t,e){var n={},r={};return _.each(t,function(t,i){var a=o(i),s=i;$.each(a,function(t,n){var r=e[n];null!==r&&void 0!==r&&(_.isArray(r)&&(r=r[r.length-1]),i=i.replace("<"+n+">",r))}),n[i]=s,r[i]=t}),{interpolated:r,interpolationMap:n}},u={"private":{getInnerVariables:o,interpolate:s},innerVariablesList:[],variableListenerMap:{},refresh:function(){var t=this,n=function(n,r){return e.query(n).then(function(e){console.log("Got variables",e),_.each(e,function(e,n){var o=i[n];if(!a(e,o)){i[n]=e;var s=r&&r[n]?r[n]:n;t.notify(s,e)}})})};return t.innerVariablesList.length?e.query(t.innerVariablesList).then(function(e){console.log("inner",e),$.extend(i,e);var r=s(t.variableListenerMap,e),a=_.keys(r.interpolated);n(a,r.interpolationMap)}):n(_.keys(t.variableListenerMap))},notify:function(t,e){var r=this.variableListenerMap[t],i={};i[t]=e,_.each(r,function(t){t.target.trigger(n.events.react,i)})},publish:function(t,n){var r;$.isPlainObject(t)?r=t:(r={})[t]=n;var a=s(r,i).interpolated,o=this;e.save.call(e,a).then(function(){o.refresh.call(o)})},subscribe:function(t,e){console.log("subscribing",t,e),t=[].concat(t),e.on||(e=$(e));var n=_.uniqueId("epichannel.variable"),r={id:n,target:e},i=this;return $.each(t,function(t,e){var n=o(e);n.length&&(i.innerVariablesList=i.innerVariablesList.concat(n)),i.innerVariablesList=_.uniq(i.innerVariablesList),i.variableListenerMap[e]||(i.variableListenerMap[e]=[]),i.variableListenerMap[e]=i.variableListenerMap[e].concat(r)}),n},unsubscribe:function(t,e){this.variableListenerMap=_.reject(this.variableListenerMap,function(t){return t.id===e})},unsubscribeAll:function(){this.variableListenerMap={},this.innerVariablesList=[]}};$.extend(this,u);var c=this;$(r).on("dirty",function(){c.refresh.apply(c,arguments)})}},{"../config":8}],12:[function(t,e){"use strict";e.exports={alias:"i",convert:function(t){return parseFloat(t,10)}}},{}],13:[function(t,e){"use strict";e.exports={s:function(t){return t+""},upperCase:function(t){return(t+"").toUpperCase()},lowerCase:function(t){return(t+"").toLowerCase()},titleCase:function(t){return t+="",t.replace(/\w\S*/g,function(t){return t.charAt(0).toUpperCase()+t.substr(1).toLowerCase()})}}},{}],14:[function(t,e){"use strict";e.exports={alias:function(t){return-1!==t.indexOf("#")||-1!==t.indexOf("0")},convert:function(){function t(t,e){t=0===t?0:n(t,Math.max(0,e-Math.ceil(Math.log(t)/Math.LN10)));for(var r="",i=t.toString(),a=!1,o=0;o<i.length;o++)if(r+=i.charAt(o),"."===i.charAt(o)?a=!0:e--,0>=e)return r;for(a||(r+=".");e>0;)r+="0",e--;return r}function e(t,e,n,r){r=r||!0;var i=t.toString(),a=i.split(".").length>1,o=0;if(r)for(var s=i.length-1;s>0;s--)a?a="."!==i.charAt(s):(o=(o+1)%3,0===o&&(i=i.substr(0,s)+","+i.substr(s)));if(e>0){var u;for(i.split(".").length<=1?(u=n,u>0&&(i+=".")):u=n-i.split(".")[1].length;u>0;)i+="0",u--}return i}function n(t,e){return Math.round(t*Math.pow(10,e))/Math.pow(10,e)}function r(t){t=t.replace(".","");var e=t.split(new RegExp("[0|,|#]+","g"));return e.length>1?e[1].toString():""}function i(t){var e=$.trim(t);return"$"===e||"â‚¬"===e||"Â¥"===e||"Â£"===e||"â‚¡"===e||"â‚±"===e||"KÄ?"===e||"kr"===e||"Â¢"===e||"â‚ª"===e||"Æ’"===e||"â‚©"===e||"â‚«"===e?!0:!1}function a(s,u){if(!_.isString(s)&&!_.isNumber(s))return s;if(!u||"default"===u.toLowerCase())return s.toString();if(isNaN(s))return"?";u=u.replace("&euro;","â‚¬");var c=u.split(";");if(c.length>1)return a(Math.abs(s),c[s>=0?0:1]);var l=s>=0?"":"-";s=Math.abs(s);var f=u,p=f.indexOf(".");p>-1&&(f=f.substring(0,p));var h=f.toLowerCase(),v=h.lastIndexOf("s"),d=v>-1;if(d){var g=f.charAt(v+1);" "===g&&(d=!1)}var b=d?u.substring(0,v):"",x=u.substr(d?v+1:v);if(d){var m=/[0-9#*]/,$=x.match(m);$&&0!==$.length||(d=!1,b="")}if(d){var y=0===s?0:Math.floor(Math.log(Math.abs(s))/(3*Math.LN10));if(y=s/Math.pow(10,3*y)<1e3?y:y+1,y=Math.max(y,0),y=Math.min(y,4),s/=Math.pow(10,3*y),isNaN(Number(x))||-1!==x.indexOf(".")){u=u.substr(v+1);var M=r(u);u=u.substr(0,u.length-M.length);var w=a((""===l?1:-1)*s,u)+o[y]+M;return i(b)&&""!==l?(w=w.substr(l.length),l+b+w):b+w}var L=Number(x);return s<Math.pow(10,L)?i(b)?l+b+t(s,Number(x))+o[y]:b+l+t(s,Number(x))+o[y]:i(b)?l+b+Math.round(s)+o[y]:b+l+Math.round(s)+o[y]}var C,O,k=u.split(".");k.length>1?(C=k[1].length-k[1].replace(new RegExp("[0|#]+","g"),"").length,O=k[1].length-k[1].replace(new RegExp("0+","g"),"").length,u=k[0]+k[1].replace(new RegExp("[0|#]+","g"),"")):C=0;var N=u.split(new RegExp("[0|,|#]+","g")),j=N[0].toString(),A=N.length>1?N[1].toString():"";s*=u.split("%").length>1?100:1,s=n(s,C),l=0===s?"":l;var S=","===u.substr(u.length-4-A.length,1),V=l+j+e(s,C,O,S)+A;return V}var o=["","K","M","B","T"];return a}()}},{}],18:[function(t,e){"use strict";e.exports={target:"*",test:/^(?:model|convert)$/i,handle:$.noop,init:function(){return!1}}},{}],19:[function(t,e){"use strict";e.exports={target:"*",test:function(t){return 0===t.indexOf("on-init")},init:function(t,e){t=t.replace("on-init","");var n=this;return $(function(){var t=e.split("(")[0],r=e.substring(e.indexOf("(")+1,e.indexOf(")")).split(","),i=""!==$.trim(r)?r.split(","):[];n.trigger("f.ui.operate",{fn:t,args:i})}),!1}}},{}],20:[function(t,e){"use strict";e.exports={target:"*",test:function(t){return 0===t.indexOf("on-")},init:function(t,e){t=t.replace("on-","");var n=this;return this.on(t,function(){var t=e.split("(")[0],r=e.substring(e.indexOf("(")+1,e.indexOf(")")),i=""!==$.trim(r)?r.split(","):[];n.trigger("f.ui.operate",{fn:t,args:i})}),!1}}},{}],21:[function(t,e){"use strict";e.exports={target:":checkbox,:radio",test:"bind",handle:function(t){var e=this.attr("value"),n=void 0!==e?e==t:!!t;this.prop("checked",n)}}},{}],22:[function(t,e){"use strict";e.exports={target:"input, select",test:"bind",handle:function(t){this.val(t)}}},{}],23:[function(t,e){"use strict";e.exports={test:"class",target:"*",handle:function(t,e){var n=this.data("added-classes");n||(n={}),n[e]&&this.removeClass(n[e]),_.isNumber(t)&&(t="value-"+t),n[e]=t,this.addClass(t),this.data("added-classes",n)}}},{}],24:[function(t,e){"use strict";e.exports={target:"*",test:/^(?:checked|selected|async|autofocus|autoplay|controls|defer|ismap|loop|multiple|open|required|scoped)$/i,handle:function(t,e){var n=this.attr("value")?t==this.prop("value"):!!t;this.prop(e,n)}}},{}],25:[function(t,e){"use strict";e.exports={target:"*",test:/^(?:disabled|hidden|readonly)$/i,handle:function(t,e){this.prop(e,!t)}}},{}],26:[function(t,e){"use strict";e.exports={target:"*",test:"bind",handle:function(t){this.html(t)}}},{}],27:[function(t,e){"use strict";e.exports={test:"*",target:"*",handle:function(t,e){this.prop(e,t)}}},{}],15:[function(t,e){"use strict";var n=t("./default-input-node");e.exports=n.extend({propertyHandlers:[],getUIValue:function(){var t=this.$el,e=void 0!==t.data("f-off")?t.data("f-off"):0,n=void 0!==t.attr("value")?t.prop("value"):1,r=t.is(":checked")?n:e;return r},initialize:function(){n.prototype.initialize.apply(this,arguments)}},{selector:":checkbox,:radio"})},{"./default-input-node":16}],16:[function(t,e){"use strict";var n=t("../../config"),r=t("./default-node");e.exports=r.extend({propertyHandlers:[],uiChangeEvent:"change",getUIValue:function(){return this.$el.val()},initialize:function(){var t=this;this.$el.on(this.uiChangeEvent,function(){var e=t.getUIValue(),r=t.$el.data(n.binderAttr),i={};i[r]=e,t.$el.trigger(n.events.trigger,i)}),r.prototype.initialize.apply(this,arguments)}},{selector:"input, select"})},{"./default-node":17,"../../config":8}],17:[function(t,e){"use strict";var n=t("./base");e.exports=n.extend({propertyHandlers:[],initialize:function(){}},{selector:"*"})},{"./base":28}],28:[function(t,e){"use strict";var n=function(t,e){var n,r=this;n=t&&_.has(t,"constructor")?t.constructor:function(){return r.apply(this,arguments)},_.extend(n,r,e);var i=function(){this.constructor=n};return i.prototype=r.prototype,n.prototype=new i,t&&_.extend(n.prototype,t),n.__super__=r.prototype,n},r=function(t){this.$el=$(t.el),this.el=t.el,this.initialize.apply(this,arguments)};_.extend(r.prototype,{initialize:function(){}}),r.extend=n,e.exports=r},{}]},{},[1]);