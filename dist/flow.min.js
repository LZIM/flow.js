(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
window.Flow=require("./flow.js"),window.Flow.version="0.8.2";
},{"./flow.js":28}],2:[function(require,module,exports){
"use strict";var config=require("../config");module.exports=function(options){var defaults={silent:!1};var channelOptions=$.extend(!0,{},defaults,options);var run=channelOptions.run;var vent=channelOptions.vent;var publicAPI={"private":{options:channelOptions},listenerMap:{},refresh:function(executedOpns,response,force){var silent=channelOptions.silent;var shouldSilence=silent===!0;if(_.isArray(silent)&&executedOpns&&(shouldSilence=_.intersection(silent,executedOpns).length===silent.length),$.isPlainObject(silent)&&executedOpns&&(shouldSilence=_.intersection(silent.except,executedOpns).length!==executedOpns.length),!shouldSilence||force===!0){$(vent).trigger("dirty",{opn:executedOpns,response:response});var me=this;_.each(executedOpns,function(opn){me.notify(opn,response)})}},notify:function(operation,value){var listeners=this.listenerMap[operation];var params={};params[operation]=value,_.each(listeners,function(listener){var target=listener.target;if(_.isFunction(target))target.call(null,params);else{if(!target.trigger)throw new Error("Unknown listerer format for "+operation);listener.target.trigger(config.events.react,params)}})},publish:function(operation,params,options){var me=this;if($.isPlainObject(operation)&&operation.operations){var fn=operation.serial?run.serial:run.parallel;return fn.call(run,operation.operations).then(function(response){params&&params.silent||me.refresh.call(me,_.pluck(operation.operations,"name"),response)})}var opts=$.isPlainObject(operation)?params:options;return run.do.apply(run,arguments).then(function(response){opts&&opts.silent||me.refresh.call(me,[operation],response)})},subscribe:function(operations,subscriber){operations=[].concat(operations),subscriber.on||_.isFunction(subscriber)||(subscriber=$(subscriber));var id=_.uniqueId("epichannel.operation");var data={id:id,target:subscriber};var me=this;return $.each(operations,function(index,opn){me.listenerMap[opn]||(me.listenerMap[opn]=[]),me.listenerMap[opn]=me.listenerMap[opn].concat(data)}),id},unsubscribe:function(operation,token){this.listenerMap[operation]=_.reject(this.listenerMap[operation],function(subs){return subs.id===token})},unsubscribeAll:function(){this.listenerMap={}}};return $.extend(this,publicAPI)};
},{"../config":5}],3:[function(require,module,exports){
"use strict";var VarsChannel=require("./variables-channel");var OperationsChannel=require("./operations-channel");module.exports=function(options){var defaults={run:{variables:{},operations:{}}};var config=$.extend(!0,{},defaults,options);var rm=new F.manager.RunManager(config);var rs=rm.run;var $creationPromise=rm.getRun();rs.currentPromise=$creationPromise;var createAndThen=function(fn,context){return _.wrap(fn,function(func){var passedInParams=_.toArray(arguments).slice(1);return rs.currentPromise.then(function(){return rs.currentPromise=func.apply(context,passedInParams),rs.currentPromise})})};_.each(rs,function(value,name){_.isFunction(value)&&"variables"!==name&&"create"!==name&&(rs[name]=createAndThen(value,rs))});var originalVariablesFn=rs.variables;rs.variables=function(){var vs=originalVariablesFn.apply(rs,arguments);return _.each(vs,function(value,name){_.isFunction(value)&&(vs[name]=createAndThen(value,vs))}),vs},this.run=rs,this.variables=new VarsChannel($.extend(!0,{},config.run.variables,{run:rs,vent:this})),this.operations=new OperationsChannel($.extend(!0,{},config.run.operations,{run:rs,vent:this}))};
},{"./operations-channel":2,"./variables-channel":4}],4:[function(require,module,exports){
"use strict";var config=require("../config");module.exports=function(options){var defaults={silent:!1};var channelOptions=$.extend(!0,{},defaults,options);var vs=channelOptions.run.variables();var vent=channelOptions.vent;var currentData={};var isEqual=function(){return!1};var getInnerVariables=function(str){var inner=str.match(/<(.*?)>/g);return inner=_.map(inner,function(val){return val.substring(1,val.length-1)})};var interpolate=function(variablesToInterpolate,values){var interpolationMap={};var interpolated={};return _.each(variablesToInterpolate,function(val,outerVariable){var inner=getInnerVariables(outerVariable);if(inner&&inner.length){var originalOuter=outerVariable;$.each(inner,function(index,innerVariable){var thisval=values[innerVariable];null!==thisval&&void 0!==thisval&&(_.isArray(thisval)&&(thisval=thisval[thisval.length-1]),outerVariable=outerVariable.replace("<"+innerVariable+">",thisval))}),interpolationMap[outerVariable]=interpolationMap[outerVariable]?[originalOuter].concat(interpolationMap[outerVariable]):originalOuter}interpolated[outerVariable]=val}),{interpolated:interpolated,interpolationMap:interpolationMap}};var publicAPI={"private":{getInnerVariables:getInnerVariables,interpolate:interpolate,options:channelOptions},innerVariablesList:[],variableListenerMap:{},refresh:function(changeObj,force){var me=this;var silent=channelOptions.silent;var changedVariables=_.keys(changeObj);var shouldSilence=silent===!0;if(_.isArray(silent)&&changedVariables&&(shouldSilence=_.intersection(silent,changedVariables).length>=1),$.isPlainObject(silent)&&changedVariables&&(shouldSilence=_.intersection(silent.except,changedVariables).length!==changedVariables.length),shouldSilence&&force!==!0)return $.Deferred().resolve().promise();var getVariables=function(vars,interpolationMap){return vs.query(vars).then(function(variables){_.each(variables,function(value,vname){var oldValue=currentData[vname];if(!isEqual(value,oldValue)&&(currentData[vname]=value,me.variableListenerMap[vname]&&me.notify(vname,value),interpolationMap&&interpolationMap[vname])){var map=[].concat(interpolationMap[vname]);_.each(map,function(interpolatedName){me.variableListenerMap[interpolatedName]&&me.notify(interpolatedName,value)})}})})};return me.innerVariablesList.length?vs.query(me.innerVariablesList).then(function(innerVariables){$.extend(currentData,innerVariables);var ip=interpolate(me.variableListenerMap,innerVariables);var outer=_.keys(ip.interpolated);getVariables(outer,ip.interpolationMap)}):getVariables(_.keys(me.variableListenerMap))},notify:function(variable,value){var listeners=this.variableListenerMap[variable];var params={};params[variable]=value,_.each(listeners,function(listener){var target=listener.target;if(_.isFunction(target))target.call(null,params);else{if(!target.trigger)throw new Error("Unknown listerer format for "+variable);listener.target.trigger(config.events.react,params)}})},publish:function(variable,value,options){var attrs;$.isPlainObject(variable)?(attrs=variable,options=value):(attrs={})[variable]=value;var interpolated=interpolate(attrs,currentData).interpolated;var me=this;return vs.save.call(vs,interpolated).then(function(){options&&options.silent||me.refresh.call(me,attrs)})},subscribe:function(properties,subscriber){properties=[].concat(properties),subscriber.on||_.isFunction(subscriber)||(subscriber=$(subscriber));var id=_.uniqueId("epichannel.variable");var data={id:id,target:subscriber};var me=this;return $.each(properties,function(index,property){var inner=getInnerVariables(property);inner.length&&(me.innerVariablesList=me.innerVariablesList.concat(inner)),me.innerVariablesList=_.uniq(me.innerVariablesList),me.variableListenerMap[property]||(me.variableListenerMap[property]=[]),me.variableListenerMap[property]=me.variableListenerMap[property].concat(data)}),id},unsubscribe:function(variable,token){this.variableListenerMap[variable]=_.reject(this.variableListenerMap[variable],function(subs){return subs.id===token})},unsubscribeAll:function(){this.variableListenerMap={},this.innerVariablesList=[]}};$.extend(this,publicAPI);var me=this;$(vent).off("dirty").on("dirty",function(){me.refresh.call(me,null,!0)})};
},{"../config":5}],5:[function(require,module,exports){
module.exports={prefix:"f",defaultAttr:"bind",binderAttr:"f-bind",events:{trigger:"update.f.ui",react:"update.f.model"}};
},{}],6:[function(require,module,exports){
"use strict";module.exports={list:function(val){return[].concat(val)},last:function(val){return val=[].concat(val),val[val.length-1]},first:function(val){return val=[].concat(val),val[0]},previous:function(val){return val=[].concat(val),val.length<=1?val[0]:val[val.length-2]}};
},{}],7:[function(require,module,exports){
"use strict";var normalize=function(alias,converter){var ret=[];return _.isFunction(converter)?ret.push({alias:alias,convert:converter}):_.isObject(converter)&&converter.convert?(converter.alias=alias,ret.push(converter)):_.isObject(alias)&&(alias.convert?ret.push(alias):$.each(alias,function(key,val){ret.push({alias:key,convert:val})})),ret};var matchConverter=function(alias,converter){return _.isString(converter.alias)?alias===converter.alias:_.isFunction(converter.alias)?converter.alias(alias):_.isRegex(converter.alias)?converter.alias.match(alias):!1};var converterManager={"private":{matchConverter:matchConverter},list:[],register:function(alias,converter){var normalized=normalize(alias,converter);this.list=normalized.concat(this.list)},replace:function(alias,converter){var index;_.each(this.list,function(currentConverter,i){return matchConverter(alias,currentConverter)?(index=i,!1):void 0}),this.list.splice(index,1,normalize(alias,converter)[0])},getConverter:function(alias){return _.find(this.list,function(converter){return matchConverter(alias,converter)})},convert:function(value,list){if(!list||!list.length)return value;list=[].concat(list),list=_.invoke(list,"trim");var currentValue=value;var me=this;return _.each(list,function(converterName){var converter=me.getConverter(converterName);currentValue=converter.convert(currentValue,converterName)}),currentValue},parse:function(value,list){if(!list||!list.length)return value;list=[].concat(list).reverse(),list=_.invoke(list,"trim");var currentValue=value;var me=this;return _.each(list,function(converterName){var converter=me.getConverter(converterName);converter.parse&&(currentValue=converter.parse(currentValue,converterName))}),currentValue}};var defaultconverters=[require("./number-converter"),require("./string-converter"),require("./array-converter"),require("./numberformat-converter")];$.each(defaultconverters.reverse(),function(index,converter){converterManager.register(converter)}),module.exports=converterManager;
},{"./array-converter":6,"./number-converter":8,"./numberformat-converter":9,"./string-converter":10}],8:[function(require,module,exports){
"use strict";module.exports={alias:"i",convert:function(value){return parseFloat(value,10)}};
},{}],9:[function(require,module,exports){
"use strict";module.exports={alias:function(name){return-1!==name.indexOf("#")||-1!==name.indexOf("0")},parse:function(val){val+="";var isNegative="-"===val.charAt(0);val=val.replace(/,/g,"");var floatMatcher=/([-+]?[0-9]*\.?[0-9]+)(K?M?B?%?)/i;var results=floatMatcher.exec(val);var number,suffix="";switch(results&&results[1]&&(number=results[1]),results&&results[2]&&(suffix=results[2].toLowerCase()),suffix){case"%":number/=100;break;case"k":number=1e3*number;break;case"m":number=1e6*number;break;case"b":number=1e9*number}return number=parseFloat(number),isNegative&&number>0&&(number=-1*number),number},convert:function(){function getDigits(value,digits){value=0===value?0:roundTo(value,Math.max(0,digits-Math.ceil(Math.log(value)/Math.LN10)));var TXT="";var numberTXT=value.toString();var decimalSet=!1;for(var iTXT=0;iTXT<numberTXT.length;iTXT++)if(TXT+=numberTXT.charAt(iTXT),"."===numberTXT.charAt(iTXT)?decimalSet=!0:digits--,0>=digits)return TXT;for(decimalSet||(TXT+=".");digits>0;)TXT+="0",digits--;return TXT}function addDecimals(value,decimals,minDecimals,hasCommas){hasCommas=hasCommas||!0;var numberTXT=value.toString();var hasDecimals=numberTXT.split(".").length>1;var iDec=0;if(hasCommas)for(var iChar=numberTXT.length-1;iChar>0;iChar--)hasDecimals?hasDecimals="."!==numberTXT.charAt(iChar):(iDec=(iDec+1)%3,0===iDec&&(numberTXT=numberTXT.substr(0,iChar)+","+numberTXT.substr(iChar)));if(decimals>0){var toADD;for(numberTXT.split(".").length<=1?(toADD=minDecimals,toADD>0&&(numberTXT+=".")):toADD=minDecimals-numberTXT.split(".")[1].length;toADD>0;)numberTXT+="0",toADD--}return numberTXT}function roundTo(value,digits){return Math.round(value*Math.pow(10,digits))/Math.pow(10,digits)}function getSuffix(formatTXT){formatTXT=formatTXT.replace(".","");var fixesTXT=formatTXT.split(new RegExp("[0|,|#]+","g"));return fixesTXT.length>1?fixesTXT[1].toString():""}function isCurrency(string){var s=$.trim(string);return"$"===s||"â‚¬"===s||"Â¥"===s||"Â£"===s||"â‚¡"===s||"â‚±"===s||"KÄ?"===s||"kr"===s||"Â¢"===s||"â‚ª"===s||"Æ’"===s||"â‚©"===s||"â‚«"===s?!0:!1}function format(number,formatTXT){if(_.isArray(number)&&(number=number[number.length-1]),!_.isString(number)&&!_.isNumber(number))return number;if(!formatTXT||"default"===formatTXT.toLowerCase())return number.toString();if(isNaN(number))return"?";formatTXT=formatTXT.replace("&euro;","â‚¬");var formats=formatTXT.split(";");if(formats.length>1)return format(Math.abs(number),formats[number>=0?0:1]);var sign=number>=0?"":"-";number=Math.abs(number);var leftOfDecimal=formatTXT;var d=leftOfDecimal.indexOf(".");d>-1&&(leftOfDecimal=leftOfDecimal.substring(0,d));var normalized=leftOfDecimal.toLowerCase();var index=normalized.lastIndexOf("s");var isShortFormat=index>-1;if(isShortFormat){var nextChar=leftOfDecimal.charAt(index+1);" "===nextChar&&(isShortFormat=!1)}var leadingText=isShortFormat?formatTXT.substring(0,index):"";var rightOfPrefix=formatTXT.substr(isShortFormat?index+1:index);if(isShortFormat){var shortFormatTest=/[0-9#*]/;var shortFormatTestResult=rightOfPrefix.match(shortFormatTest);shortFormatTestResult&&0!==shortFormatTestResult.length||(isShortFormat=!1,leadingText="")}if(isShortFormat){var valScale=0===number?0:Math.floor(Math.log(Math.abs(number))/(3*Math.LN10));if(valScale=number/Math.pow(10,3*valScale)<1e3?valScale:valScale+1,valScale=Math.max(valScale,0),valScale=Math.min(valScale,4),number/=Math.pow(10,3*valScale),isNaN(Number(rightOfPrefix))||-1!==rightOfPrefix.indexOf(".")){formatTXT=formatTXT.substr(index+1);var SUFFIX=getSuffix(formatTXT);formatTXT=formatTXT.substr(0,formatTXT.length-SUFFIX.length);var valWithoutLeading=format((""===sign?1:-1)*number,formatTXT)+scales[valScale]+SUFFIX;return isCurrency(leadingText)&&""!==sign?(valWithoutLeading=valWithoutLeading.substr(sign.length),sign+leadingText+valWithoutLeading):leadingText+valWithoutLeading}var limitDigits=Number(rightOfPrefix);return number<Math.pow(10,limitDigits)?isCurrency(leadingText)?sign+leadingText+getDigits(number,Number(rightOfPrefix))+scales[valScale]:leadingText+sign+getDigits(number,Number(rightOfPrefix))+scales[valScale]:isCurrency(leadingText)?sign+leadingText+Math.round(number)+scales[valScale]:leadingText+sign+Math.round(number)+scales[valScale]}var subFormats=formatTXT.split(".");var decimals;var minDecimals;subFormats.length>1?(decimals=subFormats[1].length-subFormats[1].replace(new RegExp("[0|#]+","g"),"").length,minDecimals=subFormats[1].length-subFormats[1].replace(new RegExp("0+","g"),"").length,formatTXT=subFormats[0]+subFormats[1].replace(new RegExp("[0|#]+","g"),"")):decimals=0;var fixesTXT=formatTXT.split(new RegExp("[0|,|#]+","g"));var preffix=fixesTXT[0].toString();var suffix=fixesTXT.length>1?fixesTXT[1].toString():"";number*=formatTXT.split("%").length>1?100:1,number=roundTo(number,decimals),sign=0===number?"":sign;var hasCommas=","===formatTXT.substr(formatTXT.length-4-suffix.length,1);var formatted=sign+preffix+addDecimals(number,decimals,minDecimals,hasCommas)+suffix;return formatted}var scales=["","K","M","B","T"];return format}()};
},{}],10:[function(require,module,exports){
"use strict";module.exports={s:function(val){return val+""},upperCase:function(val){return(val+"").toUpperCase()},lowerCase:function(val){return(val+"").toLowerCase()},titleCase:function(val){return val+="",val.replace(/\w\S*/g,function(txt){return txt.charAt(0).toUpperCase()+txt.substr(1).toLowerCase()})}};
},{}],11:[function(require,module,exports){
"use strict";var defaultHandlers=[require("./no-op-attr"),require("./events/init-event-attr"),require("./events/default-event-attr"),require("./binds/checkbox-radio-bind-attr"),require("./binds/input-bind-attr"),require("./class-attr"),require("./positive-boolean-attr"),require("./negative-boolean-attr"),require("./binds/default-bind-attr"),require("./default-attr")];var handlersList=[];var normalize=function(attributeMatcher,nodeMatcher,handler){return nodeMatcher||(nodeMatcher="*"),_.isFunction(handler)&&(handler={handle:handler}),$.extend(handler,{test:attributeMatcher,target:nodeMatcher})};$.each(defaultHandlers,function(index,handler){handlersList.push(normalize(handler.test,handler.target,handler))});var matchAttr=function(matchExpr,attr,$el){var attrMatch;return _.isString(matchExpr)?attrMatch="*"===matchExpr||matchExpr.toLowerCase()===attr.toLowerCase():_.isFunction(matchExpr)?attrMatch=matchExpr(attr,$el):_.isRegExp(matchExpr)&&(attrMatch=attr.match(matchExpr)),attrMatch};var matchNode=function(target,nodeFilter){return _.isString(nodeFilter)?nodeFilter===target:nodeFilter.is(target)};module.exports={list:handlersList,register:function(){handlersList.unshift(normalize.apply(null,arguments))},filter:function(attrFilter,nodeFilter){var filtered=_.select(handlersList,function(handler){return matchAttr(handler.test,attrFilter)});return nodeFilter&&(filtered=_.select(filtered,function(handler){return matchNode(handler.target,nodeFilter)})),filtered},replace:function(attrFilter,nodeFilter,handler){var index;_.each(handlersList,function(currentHandler,i){return matchAttr(currentHandler.test,attrFilter)&&matchNode(currentHandler.target,nodeFilter)?(index=i,!1):void 0}),handlersList.splice(index,1,normalize(attrFilter,nodeFilter,handler))},getHandler:function(property,$el){var filtered=this.filter(property,$el);return filtered[0]}};
},{"./binds/checkbox-radio-bind-attr":12,"./binds/default-bind-attr":13,"./binds/input-bind-attr":14,"./class-attr":15,"./default-attr":16,"./events/default-event-attr":17,"./events/init-event-attr":18,"./negative-boolean-attr":19,"./no-op-attr":20,"./positive-boolean-attr":21}],12:[function(require,module,exports){
"use strict";module.exports={target:":checkbox,:radio",test:"bind",handle:function(value){_.isArray(value)&&(value=value[value.length-1]);var settableValue=this.attr("value");var isChecked=void 0!==settableValue?settableValue==value:!!value;this.prop("checked",isChecked)}};
},{}],13:[function(require,module,exports){
"use strict";module.exports={target:"*",test:"bind",handle:function(value){_.isArray(value)&&(value=value[value.length-1]),this.html(value)}};
},{}],14:[function(require,module,exports){
"use strict";module.exports={target:"input, select",test:"bind",handle:function(value){_.isArray(value)&&(value=value[value.length-1]),this.val(value)}};
},{}],15:[function(require,module,exports){
"use strict";module.exports={test:"class",target:"*",handle:function(value,prop){_.isArray(value)&&(value=value[value.length-1]);var addedClasses=this.data("added-classes");addedClasses||(addedClasses={}),addedClasses[prop]&&this.removeClass(addedClasses[prop]),_.isNumber(value)&&(value="value-"+value),addedClasses[prop]=value,this.addClass(value),this.data("added-classes",addedClasses)}};
},{}],16:[function(require,module,exports){
"use strict";module.exports={test:"*",target:"*",handle:function(value,prop){this.prop(prop,value)}};
},{}],17:[function(require,module,exports){
"use strict";module.exports={target:"*",test:function(attr){return 0===attr.indexOf("on-")},init:function(attr,value){attr=attr.replace("on-","");var me=this;return this.off(attr).on(attr,function(){var listOfOperations=_.invoke(value.split("|"),"trim");listOfOperations=listOfOperations.map(function(value){var fnName=value.split("(")[0];var params=value.substring(value.indexOf("(")+1,value.indexOf(")"));var args=""!==$.trim(params)?params.split(","):[];return{name:fnName,params:args}}),me.trigger("f.ui.operate",{operations:listOfOperations,serial:!0})}),!1}};
},{}],18:[function(require,module,exports){
"use strict";module.exports={target:"*",test:function(attr){return 0===attr.indexOf("on-init")},init:function(attr,value){attr=attr.replace("on-init","");var me=this;return $(function(){var listOfOperations=_.invoke(value.split("|"),"trim");listOfOperations=listOfOperations.map(function(value){var fnName=value.split("(")[0];var params=value.substring(value.indexOf("(")+1,value.indexOf(")"));var args=""!==$.trim(params)?params.split(","):[];return{name:fnName,params:args}}),me.trigger("f.ui.operate",{operations:listOfOperations,serial:!0})}),!1}};
},{}],19:[function(require,module,exports){
"use strict";module.exports={target:"*",test:/^(?:disabled|hidden|readonly)$/i,handle:function(value,prop){_.isArray(value)&&(value=value[value.length-1]),this.prop(prop,!value)}};
},{}],20:[function(require,module,exports){
"use strict";module.exports={target:"*",test:/^(?:model|convert)$/i,handle:$.noop,init:function(){return!1}};
},{}],21:[function(require,module,exports){
"use strict";module.exports={target:"*",test:/^(?:checked|selected|async|autofocus|autoplay|controls|defer|ismap|loop|multiple|open|required|scoped)$/i,handle:function(value,prop){_.isArray(value)&&(value=value[value.length-1]);var val=this.attr("value")?value==this.prop("value"):!!value;this.prop(prop,val)}};
},{}],22:[function(require,module,exports){
module.exports=function(){"use strict";var config=require("../config");var nodeManager=require("./nodes/node-manager");var attrManager=require("./attributes/attribute-manager");var converterManager=require("../converters/converter-manager");var parseUtils=require("../utils/parse-utils");var domUtils=require("../utils/dom");$.expr[":"][config.prefix]=function(obj){var $this=$(obj);var dataprops=_.keys($this.data());var match=_.find(dataprops,function(attr){return 0===attr.indexOf(config.prefix)});return!!match},$.expr[":"].webcomponent=function(obj){return-1!==obj.nodeName.indexOf("-")};var publicAPI={nodes:nodeManager,attributes:attrManager,converters:converterManager,"private":{matchedElements:[]},initialize:function(options){var defaults={root:"body",channel:null};$.extend(defaults,options);var channel=defaults.channel;this.options=defaults;var me=this;var $root=$(defaults.root);$(function(){var matchedElements=$root.find(":"+config.prefix);$root.is(":"+config.prefix)&&(matchedElements=matchedElements.add($(defaults.root))),me.private.matchedElements=matchedElements,$.each(matchedElements,function(index,element){var $el=$(element);var Handler=nodeManager.getHandler($el);new Handler.handle({el:element});var varMap=$el.data("variable-attr-map");varMap||(varMap={},$(element.attributes).each(function(index,nodeMap){var attr=nodeMap.nodeName;var attrVal=nodeMap.value;var wantedPrefix="data-f-";if(0===attr.indexOf(wantedPrefix)){attr=attr.replace(wantedPrefix,"");var handler=attrManager.getHandler(attr,$el);var isBindableAttr=!0;if(handler&&handler.init&&(isBindableAttr=handler.init.call($el,attr,attrVal)),isBindableAttr){var withConv=_.invoke(attrVal.split("|"),"trim");withConv.length>1&&(attrVal=withConv.shift(),$el.data("f-converters-"+attr,withConv));var commaRegex=/,(?![^\[]*\])/;attrVal.split(commaRegex).length>1||(varMap[attrVal]=attr)}}}),$el.data("variable-attr-map",varMap));var subscribable=Object.keys(varMap);subscribable.length&&channel.variables.subscribe(Object.keys(varMap),$el)}),$root.trigger("f.domready"),$root.off(config.events.react).on(config.events.react,function(evt,data){var $el=$(evt.target);var varmap=$el.data("variable-attr-map");var convertible={};$.each(data,function(variableName,value){var propertyToUpdate=varmap[variableName.trim()];propertyToUpdate&&(convertible[propertyToUpdate]=value)}),$el.trigger("f.convert",convertible)}),$root.off(config.events.trigger).on(config.events.trigger,function(evt,data){var parsedData={};var $el=$(evt.target);var attrConverters=domUtils.getConvertersList($el,"bind");_.each(data,function(val,key){key=key.split("|")[0].trim(),val=converterManager.parse(val,attrConverters),parsedData[key]=parseUtils.toImplicitType(val),$el.trigger("f.convert",{bind:val})}),channel.variables.publish(parsedData)}),$root.off("f.convert").on("f.convert",function(evt,data){var $el=$(evt.target);var convert=function(val,prop){prop=prop.toLowerCase();var attrConverters=domUtils.getConvertersList($el,prop);var handler=attrManager.getHandler(prop,$el);var convertedValue=converterManager.convert(val,attrConverters);handler.handle.call($el,convertedValue,prop)};$.isPlainObject(data)?_.each(data,convert):convert(data,"bind")}),$root.off("f.ui.operate").on("f.ui.operate",function(evt,data){data=$.extend(!0,{},data),_.each(data.operations,function(opn){opn.params=_.map(opn.params,function(val){return parseUtils.toImplicitType($.trim(val))})}),channel.operations.publish(data)})})}};return $.extend(this,publicAPI)}();
},{"../config":5,"../converters/converter-manager":7,"../utils/dom":29,"../utils/parse-utils":30,"./attributes/attribute-manager":11,"./nodes/node-manager":27}],23:[function(require,module,exports){
"use strict";var extend=function(protoProps,staticProps){var parent=this;var child;child=protoProps&&_.has(protoProps,"constructor")?protoProps.constructor:function(){return parent.apply(this,arguments)},_.extend(child,parent,staticProps);var Surrogate=function(){this.constructor=child};return Surrogate.prototype=parent.prototype,child.prototype=new Surrogate,protoProps&&_.extend(child.prototype,protoProps),child.__super__=parent.prototype,child};var View=function(options){this.$el=$(options.el),this.el=options.el,this.initialize.apply(this,arguments)};_.extend(View.prototype,{initialize:function(){}}),View.extend=extend,module.exports=View;
},{}],24:[function(require,module,exports){
"use strict";var config=require("../../config");var BaseView=require("./default-node");module.exports=BaseView.extend({propertyHandlers:[],uiChangeEvent:"change",getUIValue:function(){return this.$el.val()},initialize:function(){var me=this;var propName=this.$el.data(config.binderAttr);propName&&this.$el.off(this.uiChangeEvent).on(this.uiChangeEvent,function(){var val=me.getUIValue();var params={};params[propName]=val,me.$el.trigger(config.events.trigger,params)}),BaseView.prototype.initialize.apply(this,arguments)}},{selector:"input, select"});
},{"../../config":5,"./default-node":25}],25:[function(require,module,exports){
"use strict";var BaseView=require("./base");module.exports=BaseView.extend({propertyHandlers:[],initialize:function(){}},{selector:"*"});
},{"./base":23}],26:[function(require,module,exports){
"use strict";var BaseView=require("./default-input-node");module.exports=BaseView.extend({propertyHandlers:[],getUIValue:function(){var $el=this.$el;var offVal=void 0!==$el.data("f-off")?$el.data("f-off"):0;var onVal=void 0!==$el.attr("value")?$el.prop("value"):1;var val=$el.is(":checked")?onVal:offVal;return val},initialize:function(){BaseView.prototype.initialize.apply(this,arguments)}},{selector:":checkbox,:radio"});
},{"./default-input-node":24}],27:[function(require,module,exports){
"use strict";var normalize=function(selector,handler){return _.isFunction(handler)&&(handler={handle:handler}),selector||(selector="*"),handler.selector=selector,handler};var match=function(toMatch,node){return _.isString(toMatch)?toMatch===node.selector:$(toMatch).is(node.selector)};var nodeManager={list:[],register:function(selector,handler){this.list.unshift(normalize(selector,handler))},getHandler:function(selector){return _.find(this.list,function(node){return match(selector,node)})},replace:function(selector,handler){var index;_.each(this.list,function(currentHandler,i){return selector===currentHandler.selector?(index=i,!1):void 0}),this.list.splice(index,1,normalize(selector,handler))}};var defaultHandlers=[require("./input-checkbox-node"),require("./default-input-node"),require("./default-node")];_.each(defaultHandlers.reverse(),function(handler){nodeManager.register(handler.selector,handler)}),module.exports=nodeManager;
},{"./default-input-node":24,"./default-node":25,"./input-checkbox-node":26}],28:[function(require,module,exports){
"use strict";var domManager=require("./dom/dom-manager");var Channel=require("./channels/run-channel");module.exports={dom:domManager,initialize:function(config){var model=$("body").data("f-model");var defaults={channel:{run:{account:"",project:"",model:model,operations:{}}},dom:{root:"body"}};var options=$.extend(!0,{},defaults,config);this.channel=config&&config.channel&&config.channel instanceof Channel?config.channel:new Channel(options.channel);var $root=$(options.dom.root);var initFn=$root.data("f-on-init");var opnSilent=options.channel.run.operations.silent;var isInitOperationSilent=initFn&&(opnSilent===!0||_.isArray(opnSilent)&&_.contains(opnSilent,initFn));var preFetchVariables=!initFn||isInitOperationSilent;var me=this;preFetchVariables&&$root.off("f.domready").on("f.domready",function(){me.channel.variables.refresh(null,!0)}),domManager.initialize($.extend(!0,{channel:this.channel},options.dom))}};
},{"./channels/run-channel":3,"./dom/dom-manager":22}],29:[function(require,module,exports){
"use strict";module.exports={match:function(matchExpr,matchValue,context){return _.isString(matchExpr)?"*"===matchExpr||matchExpr.toLowerCase()===matchValue.toLowerCase():_.isFunction(matchExpr)?matchExpr(matchValue,context):_.isRegExp(matchExpr)?matchValue.match(matchExpr):void 0},getConvertersList:function($el,property){var attrConverters=$el.data("f-converters-"+property);if(!attrConverters&&"bind"===property){if(attrConverters=$el.data("f-convert"),!attrConverters){var $parentEl=$el.closest("[data-f-convert]");$parentEl&&(attrConverters=$parentEl.data("f-convert"))}attrConverters&&(attrConverters=attrConverters.split("|"))}return attrConverters}};
},{}],30:[function(require,module,exports){
"use strict";module.exports={toImplicitType:function(data){var rbrace=/^(?:\{.*\}|\[.*\])$/;var converted=data;return"string"==typeof data&&(data=data.trim(),"true"===data?converted=!0:"false"===data?converted=!1:"null"===data?converted=null:"undefined"===data?converted="":"'"===converted.charAt(0)||'"'===converted.charAt(0)?converted=data.substring(1,data.length-1):$.isNumeric(data)?converted=+data:rbrace.test(data)&&(converted=$.parseJSON(data))),converted}};
},{}]},{},[1])


//# sourceMappingURL=flow.min.js.map